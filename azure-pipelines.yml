trigger: none

pool: App   # Tumhara self-hosted Linux VM agent

steps:

# 1️⃣ Install prerequisites + PowerShell Core
- script: |
    sudo apt-get update
    sudo apt-get install -y wget apt-transport-https software-properties-common
    wget https://packages.microsoft.com/config/ubuntu/22.04/packages-microsoft-prod.deb
    sudo dpkg -i packages-microsoft-prod.deb
    sudo apt-get update
    sudo apt-get install -y powershell
  displayName: "Install PowerShell Core (pwsh)"

# 2️⃣ Install Node.js + npm
- task: PowerShell@2
  displayName: "Install Node.js and npm"
  inputs:
    targetType: 'inline'
    script: |
      curl -fsSL https://deb.nodesource.com/setup_lts.x | sudo -E bash -
      sudo apt-get install -y nodejs
      node -v
      npm -v

# 3️⃣ Install Node Packages
- task: PowerShell@2
  displayName: "Install Node Packages (npm install)"
  inputs:
    targetType: 'inline'
    script: |
      npm install

# 4️⃣ Build Project
- task: PowerShell@2
  displayName: "Build Project (npm run build)"
  inputs:
    targetType: 'inline'
    script: |
      npm run build
